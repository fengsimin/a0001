<?php
//Copyright (c) 2016 iFeiwu.com
 class Uploader extends Ifeiwu { function __construct() { } protected function postImage($request_data) { goto vGBRC; EE8zX: Qb4fM: goto Vl1Ls; jJ9MW: goto zckS5; goto r1det; UTRtm: $_FILES["\146\x69\154\x65"]["\164\x79\x70\x65"] = $_POST["\x66\151\x6c\145\137\164\x79\x70\145"]; goto IkyYU; ZPOra: $file_new_name_body = $_POST["\146\151\154\x65\x5f\x6e\145\167\137\x6e\x61\155\145\137\x62\x6f\x64\171"]; goto s2EjJ; vGBRC: $_FILES["\x66\151\x6c\145"]["\156\141\155\145"] = $_POST["\x66\151\154\145\x5f\156\x61\x6d\x65"]; goto UTRtm; xlWg8: tk1XB: goto Pvqtw; bz4oS: $image_resize = $_POST["\151\x6d\x61\147\145\x5f\x72\145\x73\151\x7a\x65"]; goto XLxjf; pSOZU: $handle->Process($upload_root . "\57" . $file_save_path); goto jJ9MW; g001h: $upload_root = "\x2e\56\57"; goto ZPOra; tHmnT: Bml8S: goto lhr1I; u7aFw: if (!$quality) { goto fXOEU; } goto kevjC; pCtg0: gZcxD: goto EOFAl; OFoxT: Qo03V: goto K8JIk; EABja: $quality = end($jpeg_quality); goto u7aFw; DvBCa: $image_x = explode("\x2c", $_POST["\151\x6d\141\147\x65\137\170"]); goto O1PgM; wqYT3: tsKLH: goto fIZpw; YPzbD: $file_save_path = ''; goto EE8zX; ZFrSU: $_FILES["\x66\x69\154\145"]["\145\x72\x72\157\x72"] = $_POST["\146\151\154\x65\137\145\x72\162\157\162"]; goto IqkRZ; IkyYU: $_FILES["\x66\x69\154\145"]["\x73\151\172\145"] = $_POST["\146\151\x6c\145\x5f\163\x69\x7a\x65"]; goto ZFrSU; kpfm_: $handle = new Upload($_FILES["\146\x69\154\x65"]); goto nQZK2; h5mQf: $handle->image_convert = $image_convert; goto xlWg8; rt1_a: goto dHJG2; goto Nyp2m; nQZK2: if (!$handle->uploaded) { goto gZcxD; } goto g001h; fIZpw: $handle->file_overwrite = $file_overwrite ? true : false; goto pSOZU; AhIoi: fXOEU: goto i6Mvo; Zockh: $handle->file_new_name_body = $file_new_name_body; goto wqYT3; MeMvH: if ($image_resize == 1) { goto nlrgt; } goto EABja; K8JIk: zckS5: goto pCtg0; Nyp2m: IOPQI: goto x3FkK; IqkRZ: if (!empty($_FILES["\146\x69\x6c\x65"])) { goto Bml8S; } goto q7fuO; H2Vg1: return $this->error($handle->log); goto rt1_a; EOFAl: if ($handle->processed) { goto IOPQI; } goto H2Vg1; FVd6w: $file_name_body_pre = explode("\54", $_POST["\x66\151\154\145\x5f\x6e\141\155\x65\137\142\157\144\171\x5f\160\x72\145"]); goto DvBCa; Vl1Ls: return $this->success('', array("\160\x61\x74\x68" => $file_save_path, "\x69\x6d\x61\x67\x65" => $handle->file_dst_name, "\163\x69\172\x65" => $handle->file_src_size, "\x77\x69\144\164\150" => $handle->image_src_x, "\150\x65\151\x67\150\x74" => $handle->image_src_y, "\164\x79\160\145" => $handle->image_dst_type, "\x65\170\x74" => $handle->file_dst_name_ext)); goto uqnhW; Pvqtw: if (!$file_new_name_body) { goto tsKLH; } goto Zockh; lhr1I: ifeiwu\Loader::import("\x65\170\x74\145\156\144\x2f\x55\x70\154\157\x61\x64"); goto kpfm_; q7fuO: return $this->error("\xe6\x97\240\346\225\210\xe7\x9a\x84\346\x96\x87\xe4\273\xb6\xe4\277\241\xe6\x81\xaf\xef\xbc\x81"); goto BK0Nk; i6Mvo: if (!$image_convert) { goto tk1XB; } goto h5mQf; AKi6P: foreach ($file_name_body_pre as $key => $prefix) { goto iSXZV; bqX8_: if ($height && $handle->image_src_y > $height) { goto famw6; } goto s4kC7; tgmCk: if (!$prefix) { goto q2Slq; } goto vkvFK; yzU_d: he1GJ: goto NqCvv; ODxMd: $handle->jpeg_quality = $quality; goto UpoOD; qjIby: if (!$image_convert) { goto he1GJ; } goto PBNd_; tYLKS: k0dom: goto xsmBi; AbZRd: famw6: goto ZdqpY; OQjFw: if (!$file_new_name_body) { goto B3FoH; } goto gpQE1; vkvFK: $handle->image_resize = $image_resize ? true : false; goto J3z8W; s4kC7: $handle->image_ratio_y = true; goto Yz48_; Ypq04: $handle->image_x = $handle->image_src_x; goto S8Fbr; ZdqpY: $handle->image_y = $height; goto q4cg3; NqCvv: if ($width && $handle->image_src_x > $width) { goto k0dom; } goto Ypq04; W96D3: if (!$quality) { goto EhLrU; } goto ODxMd; Yz48_: goto jeDko; goto AbZRd; l5y3Z: vFsaF: goto bqX8_; UpoOD: EhLrU: goto qjIby; RVEAN: q2Slq: goto W96D3; XYkbm: $handle->Process($upload_root . "\x2f" . $file_save_path); goto q4c6M; S8Fbr: goto vFsaF; goto tYLKS; O5FL6: B3FoH: goto q11n6; xsmBi: $handle->image_x = $width; goto l5y3Z; q4c6M: nyJAY: goto CO1qA; J3z8W: $handle->file_name_body_pre = $prefix; goto RVEAN; q11n6: $handle->file_overwrite = $file_overwrite ? true : false; goto XYkbm; Hzsov: $height = $image_y[$key]; goto U2LO1; U2LO1: $quality = $jpeg_quality[$key]; goto tgmCk; iSXZV: $width = $image_x[$key]; goto Hzsov; PBNd_: $handle->image_convert = $image_convert; goto yzU_d; gpQE1: $handle->file_new_name_body = $file_new_name_body; goto O5FL6; q4cg3: jeDko: goto OQjFw; CO1qA: } goto OFoxT; BK0Nk: goto TYC8J; goto tHmnT; yVzLw: $image_convert = $_POST["\151\155\x61\147\x65\x5f\x63\157\x6e\166\145\x72\x74"]; goto agnpw; s2EjJ: $file_overwrite = $_POST["\146\x69\154\x65\x5f\x6f\166\x65\162\167\162\x69\x74\145"]; goto bz4oS; XLxjf: $file_save_path = $_POST["\x66\x69\154\x65\x5f\163\141\166\x65\137\x70\141\x74\150"]; goto yVzLw; uqnhW: dHJG2: goto B6Z2j; r1det: nlrgt: goto FVd6w; x3FkK: if (!($file_save_path == "\x2f")) { goto Qb4fM; } goto YPzbD; agnpw: $jpeg_quality = explode("\x2c", $_POST["\x6a\x70\x65\x67\137\161\x75\141\x6c\x69\164\x79"]); goto MeMvH; B6Z2j: TYC8J: goto HCeTh; O1PgM: $image_y = explode("\x2c", $_POST["\x69\x6d\x61\147\x65\137\x79"]); goto AKi6P; kevjC: $handle->jpeg_quality = $quality; goto AhIoi; HCeTh: } protected function postFile($request_data) { goto OkSGE; en3fy: $temp_dir = $save_path . "\57" . $resumableIdentifier; goto m5R3p; gK1al: dVEDB: goto Ez9BR; sIPuz: $resumableFilename = $this->_UTF82GBK($_POST["\x72\x65\163\x75\x6d\141\142\x6c\145\106\x69\154\145\x6e\141\x6d\145"]); goto vQDRB; wlNcQ: $_FILES["\146\151\x6c\145"]["\x65\162\x72\x6f\x72"] = $_POST["\146\151\x6c\145\137\145\162\162\x6f\x72"]; goto DZ7jI; N9hLL: $_FILES["\146\x69\154\x65"]["\x74\171\x70\145"] = $_POST["\146\x69\x6c\145\137\x74\x79\160\x65"]; goto Aaq5a; O2ZZ6: if (!move_uploaded_file($file["\x74\x6d\160\x5f\156\x61\x6d\145"], $dest_file)) { goto jHKm2; } goto ihKQ3; Aaq5a: $_FILES["\x66\151\154\145"]["\163\x69\172\x65"] = $_POST["\146\x69\x6c\x65\x5f\x73\x69\172\x65"]; goto wlNcQ; DZ7jI: $file = $_FILES["\146\151\x6c\x65"]; goto hzcN4; Diq0Y: $this->_debug("\145\x72\162\157\x72\40" . $file["\x65\162\x72\157\162"] . "\40\x69\156\x20\x66\x69\x6c\145\x20" . $resumableFilename); goto cQrgv; Reaqu: mkdir($temp_dir, 511, true); goto xOlva; JMH1_: if (is_dir($temp_dir)) { goto MRax3; } goto Reaqu; vQDRB: $resumableChunkNumber = $_POST["\162\x65\x73\x75\x6d\x61\x62\154\145\103\x68\x75\156\x6b\x4e\165\155\142\145\162"]; goto knjyC; lIpTC: $this->_debug("\105\162\162\157\162\x20\163\141\166\x69\x6e\147\x20\50\x6d\x6f\166\x65\137\x75\160\154\x6f\141\144\145\x64\x5f\x66\x69\x6c\x65\x29\x20\143\x68\x75\x6e\153\x20" . $resumableChunkNumber . "\40\146\157\x72\40\146\151\x6c\145\40" . $resumableFilename); goto gK1al; OkSGE: $save_path = "\x2e\56\57" . $this->_UTF82GBK($_POST["\x73\141\x76\x65\x5f\160\141\164\x68"]); goto sIPuz; knjyC: $resumableIdentifier = $_POST["\162\145\163\x75\x6d\x61\142\x6c\145\x49\x64\145\156\x74\151\x66\x69\145\x72"]; goto Mv_dM; CBKl7: jHKm2: goto lIpTC; m5R3p: $dest_file = $temp_dir . "\57" . $resumableFilename . "\56\x70\x61\x72\x74" . $resumableChunkNumber; goto JMH1_; hzcN4: if (!($file["\145\x72\162\x6f\x72"] != 0)) { goto dbj3W; } goto Diq0Y; ihKQ3: $this->_createFileFromChunks($save_path, $temp_dir, $resumableFilename, $_POST["\x72\x65\x73\165\x6d\141\x62\x6c\145\x43\x68\165\156\x6b\123\151\172\x65"], $_POST["\162\145\163\x75\155\141\x62\x6c\x65\124\x6f\x74\x61\154\123\x69\172\x65"]); goto otdXs; Mv_dM: $_FILES["\146\151\x6c\145"]["\156\x61\155\145"] = $_POST["\146\151\154\x65\x5f\156\141\155\x65"]; goto N9hLL; xOlva: MRax3: goto O2ZZ6; otdXs: goto dVEDB; goto CBKl7; cQrgv: dbj3W: goto en3fy; Ez9BR: } protected function getFile() { goto fOICE; XiNRx: return 202; goto RQIjB; s8jXk: return 404; goto Mdg5K; fOICE: $save_path = "\x2e\x2e\57" . $this->_UTF82GBK($_GET["\163\141\x76\145\x5f\160\x61\164\x68"]); goto AdJje; RQIjB: ZN28N: goto CTlPB; RBEoW: P0vNl: goto XiNRx; Tfetn: $resumableChunkNumber = $_GET["\162\x65\163\x75\155\x61\x62\x6c\145\x43\150\x75\x6e\x6b\x4e\x75\x6d\x62\145\162"]; goto aZhn2; Mdg5K: goto ZN28N; goto RBEoW; ysnlH: $chunk_file = $temp_dir . "\x2f" . $resumableFilename . "\x2e\160\141\x72\x74" . $resumableChunkNumber; goto xjf2Z; Rdbb_: $temp_dir = $save_path . "\57" . $resumableIdentifier; goto ysnlH; AdJje: $resumableFilename = $this->_UTF82GBK($_GET["\162\145\x73\x75\155\x61\x62\x6c\145\x46\151\x6c\145\156\141\155\145"]); goto Tfetn; aZhn2: $resumableIdentifier = $_GET["\162\x65\x73\x75\x6d\141\142\154\145\111\x64\x65\156\164\x69\x66\151\145\162"]; goto Rdbb_; xjf2Z: if (file_exists($chunk_file)) { goto P0vNl; } goto s8jXk; CTlPB: } private function _createFileFromChunks($save_path, $temp_dir, $fileName, $chunkSize, $totalSize) { goto PYNaD; p3o8c: cthZN: goto GKig5; KKbBx: eTQ30: goto AESAM; uZLAw: goto CPc4o; goto p3o8c; vbeyT: if (!($i <= $total_files)) { goto cthZN; } goto JIaFz; UPJWn: $i = 1; goto ZA7ky; YSuou: if (!($total_files * $chunkSize >= $totalSize - $chunkSize + 1)) { goto zQQg_; } goto DU2fO; A_0UC: $this->_debug("\x63\x61\156\x6e\157\164\40\x63\x72\x65\141\x74\x65\x20\x74\150\x65\40\x64\145\x73\x74\x69\156\x61\x74\x69\157\x6e\x20\x66\x69\154\145"); goto akb5O; jeE6P: qPlj6: goto ZgXfx; saNiJ: JOa2j: goto YSuou; IzvID: foreach (scandir($temp_dir) as $file) { goto i7zLG; L6OO1: p6YpY: goto JsB69; i7zLG: if (!(stripos($file, $fileName) !== false)) { goto r2u3M; } goto gmoB5; N67I2: r2u3M: goto L6OO1; gmoB5: $total_files++; goto N67I2; JsB69: } goto saNiJ; JIaFz: fwrite($fp, file_get_contents($temp_dir . "\57" . $fileName . "\x2e\x70\x61\x72\x74" . $i)); goto KKbBx; PYNaD: $total_files = 0; goto IzvID; AESAM: $i++; goto uZLAw; DU2fO: if (($fp = fopen($save_path . "\57" . $fileName, "\167")) !== false) { goto bWAPY; } goto A_0UC; WG2HD: $this->_rrmdir($temp_dir . "\x5f\x55\116\125\x53\105\x44"); goto SuWWs; SuWWs: T1wWw: goto kquFT; K14dt: BWkKi: goto WG2HD; W9NOE: bWAPY: goto UPJWn; akb5O: return false; goto mSYaj; GKig5: fclose($fp); goto jeE6P; ZgXfx: if (rename($temp_dir, $temp_dir . "\137\125\116\x55\x53\105\104")) { goto BWkKi; } goto Oe5tr; kquFT: zQQg_: goto pAUkJ; mSYaj: goto qPlj6; goto W9NOE; MrPp3: goto T1wWw; goto K14dt; ZA7ky: CPc4o: goto vbeyT; Oe5tr: $this->_rrmdir($temp_dir); goto MrPp3; pAUkJ: } private function _rrmdir($dir) { goto Nhssz; Nhssz: if (!is_dir($dir)) { goto g_e3K; } goto WGIzy; lrlaq: rmdir($dir); goto kGxjp; kGxjp: g_e3K: goto T3zUE; dMtE5: foreach ($objects as $object) { goto cwFrD; m02_J: WldcC: goto cxky0; ZXSe4: lQkcu: goto od072; XJHYD: fSFmm: goto JBfOX; cwFrD: if (!($object != "\x2e" && $object != "\x2e\x2e")) { goto aoTX8; } goto CO8b9; od072: $this->_rrmdir($dir . "\57" . $object); goto m02_J; r3kpp: goto WldcC; goto ZXSe4; CO8b9: if (filetype($dir . "\x2f" . $object) == "\x64\x69\x72") { goto lQkcu; } goto jn1En; jn1En: unlink($dir . "\57" . $object); goto r3kpp; cxky0: aoTX8: goto XJHYD; JBfOX: } goto zRHmn; ybMgb: reset($objects); goto lrlaq; zRHmn: Unz24: goto ybMgb; WGIzy: $objects = scandir($dir); goto dMtE5; T3zUE: } }
