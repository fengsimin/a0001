<?php
//Copyright (c) 2016 iFeiwu.com
 class Trash extends Item { function __construct() { $this->table = "\x74\162\x61\x73\150"; parent::__construct(); } protected function postDelete($request_data) { goto QZx7b; PQY7s: gKf56: goto BU02Y; jBmlu: $ids = $request_data["\151\144"]; goto hkAa0; Ojw84: $this->_log("\144\145\x6c\x65\164\145", array("\x74\x69\x74\154\x65" => count($ids))); goto BlYVf; BlYVf: return $this->success(); goto gmSqV; GvSaJ: return $this->error(); goto G4RPZ; dqWg9: $this->db->commit(); goto Ojw84; Nq2oO: foreach ($ids as $id) { goto aXJ0s; Mot8j: $path = $trash["\160\141\164\x68"]; goto HgJzW; lpQGb: goto nzZ00; goto hokrc; EtKhp: wItkr: goto Xk0ff; P5cCZ: $this->_rmdir("\56\x2e\57" . $path); goto EtKhp; aXJ0s: $trash = $this->db->select($this->table)->where(array("\x69\x64", "\75", $id))->get(); goto Mot8j; hokrc: y3LjX: goto REvmj; REvmj: if (!($path && count(explode("\x2f", $path)) >= 2)) { goto wItkr; } goto P5cCZ; m27Gg: FV8ZW: goto vD0Ch; Vu_cx: $error[] = $trash["\164\x69\x74\154\145"]; goto lpQGb; Xk0ff: nzZ00: goto m27Gg; HgJzW: if ($this->db->delete($this->table, array("\x69\144", "\x3d", $id))->is()) { goto y3LjX; } goto Vu_cx; vD0Ch: } goto PQY7s; BU02Y: if (count($error) === 0) { goto g2ABI; } goto ALIMq; gmSqV: WTCaP: goto hwpEE; ALIMq: $this->db->rollBack(); goto GvSaJ; G4RPZ: goto WTCaP; goto mlLmg; QZx7b: $error = array(); goto jBmlu; hkAa0: $this->db->beginTransaction(); goto Nq2oO; mlLmg: g2ABI: goto dqWg9; hwpEE: } protected function postReplay($request_data) { goto pr05P; MgNfm: $this->_log("\x72\145\160\154\x79", array("\x74\151\164\154\x65" => count($ids))); goto sCTam; ISiDO: $this->db->rollBack(); goto l5zNG; l5zNG: return $this->error(); goto hr1iT; j4Cuw: foreach ($ids as $id) { goto OjivU; OjivU: $trash = $this->db->select($this->table)->where(array("\x69\x64", "\x3d", $id))->get(); goto Eaz3j; Eaz3j: $table = $trash["\x74\141\142\x6c\145"]; goto VmlSx; vzwTT: $this->db->delete($this->table, array("\151\x64", "\x3d", $id)); goto v4GtR; uNpy6: FvD5d: goto K2_Ps; Ynu7X: if ($isadd === false) { goto HKrtx; } goto vzwTT; r1J4r: HKrtx: goto qljen; v4GtR: goto jfreI; goto r1J4r; hFASF: jfreI: goto uNpy6; VmlSx: $isadd = $this->db->insert($table, json_decode($trash["\x64\141\164\141"], true)); goto Ynu7X; qljen: $error[] = $trash["\164\151\x74\154\x65"]; goto hFASF; K2_Ps: } goto tjK6i; pr05P: $error = array(); goto XQ539; NbF1y: $this->db->beginTransaction(); goto j4Cuw; rlB25: if (count($error) === 0) { goto oBdRW; } goto ISiDO; tjK6i: ObF45: goto rlB25; hr1iT: goto zxgpM; goto gT0PH; gT0PH: oBdRW: goto gD76k; NOKfB: zxgpM: goto qnKlI; sCTam: return $this->success(); goto NOKfB; XQ539: $ids = $request_data["\x69\144"]; goto NbF1y; gD76k: $this->db->commit(); goto MgNfm; qnKlI: } }
